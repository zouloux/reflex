const e=window.queueMicrotask??(e=>window.setTimeout(e,0)),n=(e,n)=>(typeof e)[0]==n,t=e=>["s","n"].indexOf((typeof e)[0])>=0;function r(e){return e.props.children=e.props?.children?.flat()??[]}function o(e,n,t,r){return{type:e,props:n,key:t,_ref:r}}function s(e,n,...r){let s,i,p={};if(n){for(let e in n){const t=n[e];"key"==e?s=t:"ref"==e?i=t:e.startsWith("__")||(p[e]=t)}t(n.children)?r.push(n.children):Array.isArray(n.children)&&r.concat(n.children)}return p.children=r.map((e=>t(e)?o("#T",{value:""+e}):e)),o(e,p,s,i)}function i(e){return{vnode:e,_propsProxy:p(e.props),_isDirty:!1,isMounted:!1,name:e.type.name,_mountHandlers:[],_renderHandlers:[],_unmountHandlers:[],_observables:[]}}function p(e){const n=new Proxy({},{get:(n,t)=>t in e?e[t]:void 0,set:()=>!1});return{get value(){return n},set(n){e=n}}}function l(e,t){var o;"#T"!=e.type&&(r(e).map((e=>e&&l(e,t))),e._component&&(t?((o=e._component)._mountHandlers.map((e=>{const t=e.apply(o,[]);n(t,"f")&&o._unmountHandlers.push(t)})),o._mountHandlers=[],o.isMounted=!0):function(e){e._unmountHandlers.map((n=>n.apply(e,[]))),e._observables.map((e=>e.dispose())),delete e._mountHandlers,delete e._renderHandlers,delete e._unmountHandlers,delete e._observables,e.isMounted=!1}(e._component)))}const c=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,u=/Capture$/;let d=null;function a(){return d}function f(e,n){const t=e!==(e=e.replace(u,"")),r=(e.toLowerCase()in n?e.toLowerCase():e).slice(2);return{eventName:r,eventKey:r+(t?"C":""),useCapture:t}}function m(e){e._ref&&e._ref._setFromVNode(e)}function y(e,t){const r="#T"==e.type,o=t?t.dom:r?document.createTextNode(e.props.value):document.createElement(e.type);if(r&&t){const{value:n}=e.props;n!=o.nodeValue&&(o.nodeValue=n)}return r||(t&&Object.keys(t.props).map((n=>{if("children"!=n&&(!(n in e.props)||e.props[n]!==t.props[n]))if("innerHTML"==n)o.innerHTML="";else if(n.startsWith("on")){const{eventName:e,eventKey:t,useCapture:r}=f(n,o);o.removeEventListener(e,o.__l[t],r)}else o.removeAttribute(n)})),Object.keys(e.props).map((r=>{if("children"==r)return;let s=e.props[r];if(!t||!(r in t.props)||t.props[r]!==s)if("innerHTML"==r)o.innerHTML=s;else if(r.startsWith("on")){const{eventName:e,eventKey:n,useCapture:t}=f(r,o);o.__l??=new Map,o.__l[n]=s,o.addEventListener(e,s,t)}else{if("className"==r&&(r="class"),"class"==r&&Array.isArray(s))s=s.filter((e=>!0!==e&&!!e)).join(" ").trim();else{if("style"==r&&n(s,"o"))return Object.keys(s).map((e=>function(e,t,r){"-"===t[0]?e.setProperty(t,r):null==r?e[t]="":!n(r,"n")||c.test(t)?e[t]=r:e[t]=r+"px"}(o.style,e,s[e])));if(0==s)return}s&&o.setAttribute(r,s)}}))),o}function _(e,n){const t=e.props.children?.flat(),r=n?.props.children?.flat();if(!t)return;const o=e.dom;e._keys=new Map;const s=n=>{n?.key&&(e._keys[n.key]=n)};if(!r)return void t.map((e=>{e&&(v(e),o.appendChild(e.dom),s(e))}));t.map(s);const i=r.map((n=>!(!n?.key||e._keys[n.key]))),p=n._keys;let c=0;t.map(((e,n)=>{if(i[n]&&c++,e)if(e.key&&p[e.key]&&p[e.key].type==e.type){const t=p[e.key];v(e,t),t._keep=!0;const s=n+c;r.indexOf(t)!=s&&o.insertBefore(e.dom,o.children[n])}else if(e.key&&!p[e.key])v(e),o.insertBefore(e.dom,o.children[n]),c--;else if(n in r&&r[n]&&r[n].type==e.type){const t=r[n];v(e,t),t._keep=!0}else v(e),o.insertBefore(e.dom,o.children[n]),c--})),r.map((e=>{if(e&&!e._keep){l(e,!1);const{dom:n}=e;e.dom=null,m(e),o.removeChild(n)}}))}function h(e,n){n.vnode=e,e._component=n,d=n;const t=(n._render??e.type).apply(n,[n._propsProxy.value]);return d=null,t}function v(e,t){var o;t&&t===e&&(o=t,e={...o,props:{...o.props}});let s,p,c=t?._component;if(t&&t._id&&(e._id=t._id),!c&&n(e.type,"f")){c=i(e);const t=h(e,c);n(t,"f")?(c._render=t,c.isFactory=!0):n(t,"o")&&"type"in t&&(c._render=e.type,c.isFactory=!1,s=t)}var u,d;c?(!s&&t&&!c.isFactory&&!1!==e.props.pure&&0===e.props.children.length&&(u=e.props,d=t.props,Object.keys(u).length===Object.keys(d).length&&Object.keys(u).every((e=>"children"===e||d.hasOwnProperty(e)&&u[e]===d[e])))?(e.props.children=t.props.children,e.dom=p=t.dom):s||(c._propsProxy.set(e.props),s=h(e,c)),s&&(e.props.children=r(s),e.dom=p=y(s,t),e._ref=s._ref),e._component=c,c.vnode=e,c._isDirty=!1):e.dom=p=y(e,t),m(e),p instanceof Element&&_(e,t),c&&!c.isMounted&&l(e,!0),c?._renderHandlers.map((e=>e()))}let k=[];function H(){k.map((e=>{v(e.vnode,e.vnode)})),k=[]}function b(n){0===k.length&&e(H),n._isDirty||(n._isDirty=!0,k.push(n))}function g(){let e=[];const n=n=>e=e.filter((e=>e[0]!==n));function t(t,r,o=!1){return e.push([t,r]),o&&t.apply(null,Array.isArray(o)?o:null),()=>n(t)}return{add:(e,n=!1)=>t(e,!1,n),once:e=>t(e,!0),remove:n,dispatch:(...t)=>e.map((e=>(e[1]&&n(e[0]),e[0](...t)))),clear(){e=[]},get listeners(){return e.map((e=>e[0]))}}}const C=(e,t)=>n(t,"f")?t(e):t;function w(e){let t=(e=>n(e,"f")?e():e)(e);const r=g(),{dispatch:o}=r;return delete r.dispatch,{onChanged:r,dispatch:o,get:()=>t,set(e){t=C(t,e)},dispose(){r.clear(),t=null}}}function M(e,n){const t=w(e);return{onChanged:t.onChanged,dispose:t.dispose,get value(){return t.get()},async set(e){const r=t.get();if(e=C(r,e),t.set(e),n){if(!0===await n(e,r))return void t.set(r)}t.dispatch(e,r)}}}function x(e){const n=a(),t=M(e,(()=>b(n)));return n._observables.push(t),t}function A(){const e={component:null,dom:null,_setFromVNode(n){e.dom=n.dom,e.component=n._component}};return e}function j(e,t){const r=a();if(!t)return void r._renderHandlers.push(e);let o,s=e();function i(e){o&&o(e);const r=t(s,e);o=n(r,"f")?r:null}let p=!0;r._renderHandlers.push((()=>{if(p)i(null),p=!1;else{const n=s;s=e(),s.filter(((e,t)=>n[t]!=e))&&i(n)}}))}function T(e){const n=x(0),t=()=>n.set(n.value+1),r=()=>n.set(0);let o=!0;j((()=>[n.value]),(e=>{console.log(`Counter just updated to ${e}`,o),o=!1}));const i=A();var p;return p=()=>console.log(i.dom.innerHTML),a()._mountHandlers.push(p),()=>s("div",{class:["ReflexApp",e.modifier,!1]},s("h1",{ref:i},"Hello from Reflex ",e.emoji),s("button",{onClick:t},"Increment"),"Â ",s("button",{onClick:r},"Reset"),"Â ",s("span",null,"Counter : ",n.value))}!function(e,n){const t=o("#R",{children:(r=e,Array.isArray(r)?r:[r])});var r;t.dom=n,_(t,n.__v),n.__v=t}(s(T,{modifier:"ReflexApp-darkMode",emoji:"ðŸ‘‹"}),document.body);
//# sourceMappingURL=example.02f46bf7.js.map
