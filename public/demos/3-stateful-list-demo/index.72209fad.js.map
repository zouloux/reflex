{"mappings":"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","sources":["demos/3-stateful-list-demo/index.tsx","src/reflex/debug.ts","demos/3-stateful-list-demo/StatefulListDemoApp.tsx","demos/demoHelpers.ts"],"sourcesContent":["import { h, render } from \"../../src/reflex\";\nimport { trackPerformances, setReflexDebug } from \"../../src/reflex/debug\";\nimport { StatefulDemoApp } from \"./StatefulListDemoApp\";\n\n\n// -----------------------------------------------------------------------------\n\nsetReflexDebug( true )\n\nlet renderIndex = 0\nexport function init () {\n\tconst p = trackPerformances(\"Root rendering\")\n\trender( <StatefulDemoApp render={ init } renderIndex={ renderIndex ++ } /> , document.body );\n\tp();\n}\n\ninit();\n","\n// ----------------------------------------------------------------------------- ENABLE / DISABLE\n\nlet _enableReflexDebug = false;\n\nexport function getReflexDebug () { return _enableReflexDebug }\nexport function setReflexDebug (value:boolean) {\n\t_enableReflexDebug = value\n}\n\n// ----------------------------------------------------------------------------- TRACK PERFORMANCES\n\nexport function trackPerformances ( subject:string ) {\n\tif ( !_enableReflexDebug || process.env.NODE_ENV === \"production\" )\n\t\treturn () => {};\n\tconst start = performance.now()\n\treturn () => {\n\t\tconst delta = ~~( performance.now() - start )\n\t\tconsole.info( subject, delta < 1000 ? `${delta}ms` : `${delta/1000}s`)\n\t}\n}","import { h, state } from \"../../src/reflex\";\nimport { colorList, createUID, foodList, pickRandom, rand } from \"../demoHelpers\";\n\n// ----------------------------------------------------------------------------- HELPERS\n\ninterface IListItem {\n\tname\t:string\n\tid\t\t:string\n}\n\n// ----------------------------------------------------------------------------- LIST ITEM\n\nconst listItemStyle = {\n\tborder: `1px solid black`\n}\n\ninterface IListItemProps {\n\titem\t\t\t: IListItem\n\tkey\t\t\t\t?\n\tremoveClicked\t?:\t(e) => void\n\tmoveUpClicked\t?:\t(e) => void\n\tmoveDownClicked\t?:\t(e) => void\n}\n\nfunction ListItem ( props:IListItemProps ) {\n\t// console.log( \"ListItem\" );\n\treturn <tr class=\"ListItem\" data-id={ props.item.id } style={ listItemStyle }>\n\t\t<td>{ props.item.name }</td>\n\t\t<td><button onClick={ props.moveUpClicked }>⬆</button></td>\n\t\t<td><button onClick={ props.moveDownClicked }>⬇</button></td>\n\t\t<td><button onClick={ props.removeClicked }>Remove</button></td>\n\t</tr>\n}\n\n// ----------------------------------------------------------------------------- LIST APP\n\nexport function StatefulDemoApp () {\n\n\t/**\n\t * List state and reducers\n\t */\n\n\tconst list = state<IListItem[]>([])\n\n\tconst clearList = () => {\n\t\tlist.set([])\n\t}\n\tconst addItem = ( position:\"top\"|\"bottom\", item:IListItem ) => {\n\t\tif ( position === \"bottom\" )\n\t\t\tlist.set([...list.value, item])\n\t\telse\n\t\t\tlist.set([item, ...list.value])\n\t}\n\tconst removeItem = ( item:IListItem ) => {\n\t\tlist.set( list.value.filter( currentItem => currentItem != item ) )\n\t}\n\tconst moveItem = ( item:IListItem, offset:number ) => {\n\t\tconst index = list.value.indexOf( item ) + offset\n\t\tif ( index < 0 || index >= list.value.length ) return;\n\t\tremoveItem( item )\n\t\tlist.set( [...list.value].splice( index, 0, item ) );\n\t\tconst newArray = [...list.value].splice( index, 0, item )\n\t\t// FIXME : ERROR Here ?\n\t\tlist.set( newArray );\n\t}\n\n\tfunction addRandomItems ( total:number = 0 ) {\n\t\ttotal ||= rand( 5 + list.value.length ) + 1\n\t\tfor ( let i = 0; i < total; i++ ) {\n\t\t\taddItem(\"bottom\", {\n\t\t\t\tid: createUID(),\n\t\t\t\tname: pickRandom(colorList) + \" \" + pickRandom(foodList)\n\t\t\t})\n\t\t}\n\t}\n\n\tfunction removeRandomItems () {\n\t\tconst total = rand( list.value.length ) + 1\n\t\tfor ( let i = 0; i < total; i++ ) {\n\t\t\tconst item = pickRandom( list.value )\n\t\t\tremoveItem( item as any )\n\t\t}\n\t}\n\n\t/**\n\t * Handlers\n\t */\n\n\tfunction controlSubmitted ( event:Event ) {\n\t\tevent.preventDefault()\n\t\t// TODO : Implement refs\n\t\tconst nameInput = document.getElementById(\"StatefulDemoApp_nameInput\") as HTMLInputElement\n\t\tif ( !nameInput.value ) return;\n\t\taddItem(\"top\", {\n\t\t\tname: nameInput.value,\n\t\t\tid: createUID()\n\t\t})\n\t\tnameInput.value = \"\"\n\t}\n\n\t/**\n\t * Sub-components\n\t */\n\n\tfunction Controls () {\n\t\tconsole.log(\"Controls rendered\")\n\t\treturn <div className=\"StatefulDemoApp_controls\">\n\t\t\t<table>\n\t\t\t\t<button onClick={ e => addRandomItems() }>Add random items to bottom</button>\n\t\t\t\t<button onClick={ e => addRandomItems( 1000 ) }>Add 1000 items to bottom</button>\n\t\t\t\t<button onClick={ e => removeRandomItems() }>Remove random items</button>\n\t\t\t\t<button onClick={ e => clearList() }>Clear list</button>\n\t\t\t</table>\n\t\t\t<form onSubmit={ controlSubmitted }>\n\t\t\t\t<table>\n\t\t\t\t\t<input\n\t\t\t\t\t\tid=\"StatefulDemoApp_nameInput\"\n\t\t\t\t\t\ttype=\"text\" name=\"name\" placeholder=\"Name ...\"\n\t\t\t\t\t/>\n\t\t\t\t\t<button type=\"submit\">Add to top</button>\n\t\t\t\t</table>\n\t\t\t</form>\n\t\t</div>\n\t}\n\n\t/**\n\t * Render\n\t */\n\n\treturn () => <div class=\"StatefulDemoApp\">\n\t\t{/* Optimized node, should render once */}\n\t\t<Controls />\n\t\t<h3>{ list.value.length } element{ list.value.length > 1 ? 's' : '' }</h3>\n\t\t<table>\n\t\t\t{ list.value.map( item =>\n\t\t\t\t/* Each item will be re-rendered, even with the same key */\n\t\t\t\t/* Because handlers are recreated each time list.value is mapped */\n\t\t\t\t<ListItem\n\t\t\t\t\titem={ item } key={ item.id }\n\t\t\t\t\tremoveClicked={ e => removeItem( item ) }\n\t\t\t\t\tmoveUpClicked={ e => moveItem( item, -1 ) }\n\t\t\t\t\tmoveDownClicked={ e => moveItem( item, +1 ) }\n\t\t\t\t/>\n\t\t\t)}\n\t\t</table>\n\t</div>\n}","\nexport const toHex = (n:number) => (~~n).toString(16)\nexport const createUID = () => `${toHex(Date.now())}-${toHex(Math.random() * 999999999)}`;\nexport const pickRandom = <G extends any>(array:G[]):G => array[ ~~(Math.random() * array.length) ]\nexport const rand = (max:number) => ~~(Math.random() * max)\nexport const randBoolean = (threshold = .5) => (Math.random() > threshold)\n\nexport const foodList = [\"Cheese\", \"Carrots\", \"Pastas\", \"Pizza\", \"Burgers\", \"Ham\", \"Salad\", \"Mustard\"]\nexport const colorList = [\"Red\", \"Blue\", \"Yellow\", \"Purple\", \"Orange\", \"Black\", \"White\", \"Green\"]\nexport const firstnameList = [\"Alfred\", \"Jessica\", \"Gwen\", \"Jeanne\"]\nexport const lastnameList = [\"Dupont\", \"Smith\", \"Stevensen\", \"Odea\"]\n"],"names":["$leUMy","parcelRequire","$228131962d4ca37f$var$_enableReflexDebug","$00c98e03044c15dd$export$7ea66e3774a60b67","n","toString","$00c98e03044c15dd$export$c55f232b018cefe7","Date","now","Math","random","$00c98e03044c15dd$export$2e015b6955893291","array","length","$00c98e03044c15dd$export$bb0a9c36cf454ea0","max","$00c98e03044c15dd$export$4815de0a6e6c5145","$00c98e03044c15dd$export$9afc515fe5566574","$a40376a7cf222aa1$var$listItemStyle","border","$a40376a7cf222aa1$var$ListItem","props","h","class","item","id","style","name","onClick","moveUpClicked","moveDownClicked","removeClicked","$a40376a7cf222aa1$export$b1b6fd9ef99a9213","list","state","addItem","position","set","value","removeItem","filter","currentItem","moveItem","offset","index","indexOf","splice","newArray","addRandomItems","total","i","controlSubmitted","event","preventDefault","nameInput","document","getElementById","Controls","console","log","className","e","removeRandomItems","onSubmit","type","placeholder","map","key","$b72d49706dc33fb5$var$renderIndex","$b72d49706dc33fb5$export$2cd8252107eb640b","p","render","renderIndex","body"],"version":3,"file":"index.72209fad.js.map"}