{"mappings":"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","sources":["demos/3-stateful-list-demo/index.tsx","demos/3-stateful-list-demo/StatefulListDemoApp.tsx"],"sourcesContent":["import { h, render } from \"../../src/reflex\";\nimport { trackPerformances, setReflexDebug } from \"../../src/reflex/debug\";\nimport { StatefulDemoApp } from \"./StatefulListDemoApp\";\n\n\n// -----------------------------------------------------------------------------\n\nsetReflexDebug( true )\n\nlet renderIndex = 0\nexport function init () {\n\tconst p = trackPerformances(\"Root rendering\")\n\trender( <StatefulDemoApp render={ init } renderIndex={ renderIndex ++ } /> , document.body );\n\tp();\n}\n\ninit();\n","import { h, state } from \"../../src/reflex\";\nimport { colorList, createUID, foodList, pickRandom, rand } from \"../demoHelpers\";\n\n// ----------------------------------------------------------------------------- HELPERS\n\ninterface IListItem {\n\tname\t:string\n\tid\t\t:string\n}\n\n// ----------------------------------------------------------------------------- LIST ITEM\n\nconst listItemStyle = {\n\tborder: `1px solid black`\n}\n\ninterface IListItemProps {\n\titem\t\t\t: IListItem\n\tkey\t\t\t\t?\n\tremoveClicked\t?:\t(e) => void\n\tmoveUpClicked\t?:\t(e) => void\n\tmoveDownClicked\t?:\t(e) => void\n}\n\nfunction ListItem ( props:IListItemProps ) {\n\t// console.log( \"ListItem\" );\n\treturn <tr class=\"ListItem\" data-id={ props.item.id } style={ listItemStyle }>\n\t\t<td>{ props.item.name }</td>\n\t\t<td><button onClick={ props.moveUpClicked }>⬆</button></td>\n\t\t<td><button onClick={ props.moveDownClicked }>⬇</button></td>\n\t\t<td><button onClick={ props.removeClicked }>Remove</button></td>\n\t</tr>\n}\n\n// ----------------------------------------------------------------------------- LIST APP\n\nexport function StatefulDemoApp () {\n\n\t/**\n\t * List state and reducers\n\t */\n\n\tconst list = state<IListItem[]>([])\n\n\tconst clearList = () => {\n\t\tlist.set([])\n\t}\n\tconst addItem = ( position:\"top\"|\"bottom\", item:IListItem ) => {\n\t\tif ( position === \"bottom\" )\n\t\t\tlist.set([...list.value, item])\n\t\telse\n\t\t\tlist.set([item, ...list.value])\n\t}\n\tconst removeItem = ( item:IListItem ) => {\n\t\tlist.set( list.value.filter( currentItem => currentItem != item ) )\n\t}\n\tconst moveItem = ( item:IListItem, offset:number ) => {\n\t\tconst index = list.value.indexOf( item ) + offset\n\t\tif ( index < 0 || index >= list.value.length ) return;\n\t\tremoveItem( item )\n\t\tlist.set( [...list.value].splice( index, 0, item ) );\n\t\tconst newArray = [...list.value].splice( index, 0, item )\n\t\t// FIXME : ERROR Here ?\n\t\tlist.set( newArray );\n\t}\n\n\tfunction addRandomItems ( total:number = 0 ) {\n\t\ttotal ||= rand( 5 + list.value.length ) + 1\n\t\tfor ( let i = 0; i < total; i++ ) {\n\t\t\taddItem(\"bottom\", {\n\t\t\t\tid: createUID(),\n\t\t\t\tname: pickRandom(colorList) + \" \" + pickRandom(foodList)\n\t\t\t})\n\t\t}\n\t}\n\n\tfunction removeRandomItems () {\n\t\tconst total = rand( list.value.length ) + 1\n\t\tfor ( let i = 0; i < total; i++ ) {\n\t\t\tconst item = pickRandom( list.value )\n\t\t\tremoveItem( item as any )\n\t\t}\n\t}\n\n\t/**\n\t * Handlers\n\t */\n\n\tfunction controlSubmitted ( event:Event ) {\n\t\tevent.preventDefault()\n\t\t// TODO : Implement refs\n\t\tconst nameInput = document.getElementById(\"StatefulDemoApp_nameInput\") as HTMLInputElement\n\t\tif ( !nameInput.value ) return;\n\t\taddItem(\"top\", {\n\t\t\tname: nameInput.value,\n\t\t\tid: createUID()\n\t\t})\n\t\tnameInput.value = \"\"\n\t}\n\n\t/**\n\t * Sub-components\n\t */\n\n\tfunction Controls () {\n\t\tconsole.log(\"Controls rendered\")\n\t\treturn <div className=\"StatefulDemoApp_controls\">\n\t\t\t<table>\n\t\t\t\t<button onClick={ e => addRandomItems() }>Add random items to bottom</button>\n\t\t\t\t<button onClick={ e => addRandomItems( 1000 ) }>Add 1000 items to bottom</button>\n\t\t\t\t<button onClick={ e => removeRandomItems() }>Remove random items</button>\n\t\t\t\t<button onClick={ e => clearList() }>Clear list</button>\n\t\t\t</table>\n\t\t\t<form onSubmit={ controlSubmitted }>\n\t\t\t\t<table>\n\t\t\t\t\t<input\n\t\t\t\t\t\tid=\"StatefulDemoApp_nameInput\"\n\t\t\t\t\t\ttype=\"text\" name=\"name\" placeholder=\"Name ...\"\n\t\t\t\t\t/>\n\t\t\t\t\t<button type=\"submit\">Add to top</button>\n\t\t\t\t</table>\n\t\t\t</form>\n\t\t</div>\n\t}\n\n\t/**\n\t * Render\n\t */\n\n\treturn () => <div class=\"StatefulDemoApp\">\n\t\t{/* Optimized node, should render once */}\n\t\t<Controls />\n\t\t<h3>{ list.value.length } element{ list.value.length > 1 ? 's' : '' }</h3>\n\t\t<table>\n\t\t\t{ list.value.map( item =>\n\t\t\t\t/* Each item will be re-rendered, even with the same key */\n\t\t\t\t/* Because handlers are recreated each time list.value is mapped */\n\t\t\t\t<ListItem\n\t\t\t\t\titem={ item } key={ item.id }\n\t\t\t\t\tremoveClicked={ e => removeItem( item ) }\n\t\t\t\t\tmoveUpClicked={ e => moveItem( item, -1 ) }\n\t\t\t\t\tmoveDownClicked={ e => moveItem( item, +1 ) }\n\t\t\t\t/>\n\t\t\t)}\n\t\t</table>\n\t</div>\n}"],"names":["$leUMy","parcelRequire","$a40376a7cf222aa1$var$listItemStyle","border","$a40376a7cf222aa1$var$ListItem","props","h","class","item","id","style","name","onClick","moveUpClicked","moveDownClicked","removeClicked","$a40376a7cf222aa1$export$b1b6fd9ef99a9213","list","state","addItem","position","set","value","removeItem","filter","currentItem","moveItem","offset","index","indexOf","length","splice","newArray","addRandomItems","total","$hvc62","rand","i","createUID","pickRandom","colorList","foodList","controlSubmitted","event","preventDefault","nameInput","document","getElementById","Controls","console","log","className","e","removeRandomItems","onSubmit","type","placeholder","map","key","$3AbUl","setReflexDebug","$b72d49706dc33fb5$var$renderIndex","$b72d49706dc33fb5$export$2cd8252107eb640b","p","trackPerformances","render","renderIndex","body"],"version":3,"file":"index.52c5c729.js.map"}